--resetMaxFile #noPrompt --reset the scenedelete $*fn getNewTree=(tree=Foliage CanopyMode:0 GenUV:on ShowTrunk:on ShowBranches:on ShowLeaves:on clipu:0 clipv:0 clipw:1 cliph:1 Jitter:1 color1:(color 0 0 0) color2:(color 255 255 255) phase:0 levels:3 thresholdHigh:1 shaderType:1 sampler:3 effect:0tree.LevelOfDetail = 0tree.height = 30tree.density = 0.4tree.Pruning = 0.5tree.seed =random 0 1000000tree.ShowFruit = offtree.ShowRoots = offtree.ShowFlowers = offreturn tree)fn scatterTrees numTrees forestPolygon=(local qlocal bb = nodeLocalBoundingBox forestPolygonlocal testpointlocal testraylocal intersectionlocal notValidfor q=1 to numTrees do(notValid=truetries=10	while notValid and tries>0 do(testpoint=[random bb[1].x bb[2].x, random bb[1].y bb[2].y, 0]tries=tries-1testray = ray testpoint [0, 0, -1]print testrayintersection = intersectRay forestPolygon testrayprint ("planting tree "+(q as string)+", point "+testpoint as string+", "+(intersection as string))if intersection != undefined then notValid=false)local tree=getNewTree()tree.pos=testpoint))fn createBuilding1 fields=(local obj_name=fields[2]local levels=fields[3]local height=fields[4]local points=(fields.count-4)/2local q	local sp = splineShape()sp.adaptive=falsesp.pos=[0,0,0]sp.name=obj_nameaddnewSpline spfor q=(points-1) to 0 by -1 do(addKnot sp 1 #corner #line [fields[5+q*2] as float,fields[5+q*2+1] as float,0.0]--Sphere radius:3 name:(obj_name+"_"+(q as string)+"_at_"+fields[5+q*2]+"x"+fields[5+q*2+1]) pos:[fields[5+q*2] as float,fields[5+q*2+1] as float,0.0])close sp 1updateShape sp	local extr=Extrude ()extr.amount = height as floatextr.capStart = onextr.capEnd = onaddModifier sp extrcollapseStack sp)fn createGrass1 fields=(local obj_name=fields[2]local points=(fields.count-2)/2local q	local sp = splineShape()sp.adaptive=falsesp.pos=[0,0,0]sp.name=obj_nameaddnewSpline spfor q=(points-1) to 0 by -1 do(addKnot sp 1 #corner #line [fields[3+q*2] as float,fields[3+q*2+1] as float,0.0])close sp 1updateShape sp	local extr=Extrude ()extr.amount = 0.1extr.capStart = onextr.capEnd = onaddModifier sp extrcollapseStack spsp.wireColor=(color 0 255 0))fn createForest1 fields=(local obj_name=fields[2]local points=(fields.count-2)/2local q	local sp = splineShape()sp.adaptive=falsesp.pos=[0,0,0]sp.name=obj_nameaddnewSpline spfor q=(points-1) to 0 by -1 do(addKnot sp 1 #corner #line [fields[3+q*2] as float,fields[3+q*2+1] as float,0.0])close sp 1updateShape sp	local extr=Extrude ()extr.amount = -0.1extr.capStart = onextr.capEnd = onaddModifier sp extrcollapseStack spsp.wireColor=(color 0 80 0)scatterTrees 30 sp)file=openFile (@"z:\test.txt") mode:"rt" encoding:#utf8undo off (while not (eof file); do (dline=readLine filefields=filterString dline " "	if fields[1]=="Building1" then (createBuilding1 fields)if fields[1]=="Grass1" then (createGrass1 fields)if fields[1]=="Forest1" then (createForest1 fields)))close filefree file